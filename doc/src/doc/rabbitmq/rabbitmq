消息队列分布式事务

关键在于重试
第一种：自己数据库记录消息（必须全部记录）
第二种：消息中间件自己记录消息（优点，可以只在异常情况下记录）

发送端 ：消息确认机制（消息未发送成功）
路由端：消息返回机制（消息未路由成功）
消费端： 消息确认机制（消息未消费，手动签收）

死信队列，消息过期机制（1nack并设置拒绝重回队列（不建议重回队列），2过期，3队列满了，放入死信队列）

